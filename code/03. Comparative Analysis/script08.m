% UNIVERSIDADE FEDERAL DA PARAÍBA
% CENTRO DE TECNOLOGIA
% DEPARTAMENTO DE ENGENHARIA MECÂNICA
%
% DISCENTE THIAGO NEY EVARISTO RODRIGUES
% ORIENTADOR DR. JACQUES CÉSAR DOS SANTOS
%
% TRABALHO DE CONCLUSÃO DE CURSO
% 
% ANÁLISE NUMÉRICA DE CONDUÇÃO TRANSIENTE COM TERMO FONTE VARIÁVEL EM
% VARETAS COMBUSTÍVEIS DE REATORES NUCLEARES PELO MÉTODO DAS LINHAS 

clear
close all
clc

%% Curves

c1 = 1;

r0 = 0.001;  % Beginning of the r axis
rl = 1;      % End of the r axis (Length L)
nr = 400;    % Points in spatial grid

r = linspace(r0,rl,nr);

curve01 = [11.9915017844485	11.9920021495486	11.9918928961967	11.9915771145711	11.9911021630137	11.9904831043456	11.9897266308129	11.9888362959188	11.9878142109493	11.9866617315911	11.9853797793044	11.9839690081807	11.9824298986146	11.9807628132023	11.9789680317817	11.9770457743057	11.9749962162886	11.9728194995434	11.9705157398330	11.9680850324430	11.9655274563175	11.9628430771815	11.9600319499341	11.9570941205065	11.9540296273243	11.9508385024688	11.9475207726110	11.9440764597674	11.9405055819190	11.9368081535207	11.9329841859239	11.9290336877302	11.9249566650886	11.9207531219461	11.9164230602618	11.9119664801892	11.9073833802334	11.9026737573855	11.8978376072405	11.8928749240987	11.8877857010549	11.8825699300760	11.8772276020698	11.8717587069455	11.8661632336667	11.8604411702991	11.8545925040526	11.8486172213192	11.8425153077063	11.8362867480668	11.8299315265266	11.8234496265088	11.8168410307555	11.8101057213483	11.8032436797255	11.7962548866993	11.7891393224701	11.7818969666404	11.7745277982269	11.7670317956720	11.7594089368539	11.7516591990966	11.7437825591778	11.7357789933376	11.7276484772853	11.7193909862065	11.7110064947695	11.7024949771304	11.6938564069390	11.6850907573437	11.6761980009957	11.6671781100535	11.6580310561867	11.6487568105798	11.6393553439356	11.6298266264778	11.6201706279548	11.6103873176417	11.6004766643433	11.5904386363961	11.5802732016709	11.5699803275744	11.5595599810518	11.5490121285878	11.5383367362088	11.5275337694845	11.5166031935289	11.5055449730024	11.4943590721123	11.4830454546147	11.4716040838151	11.4600349225700	11.4483379332871	11.4365130779272	11.4245603180042	11.4124796145866	11.4002709282976	11.3879342193165	11.3754694473788	11.3628765717772	11.3501555513619	11.3373063445414	11.3243289092829	11.3112232031126	11.2979891831165	11.2846268059405	11.2711360277909	11.2575168044349	11.2437690912006	11.2298928429777	11.2158880142172	11.2017545589326	11.1874924306990	11.1731015826543	11.1585819674989	11.1439335374958	11.1291562444713	11.1142500398143	11.0992148744775	11.0840506989765	11.0687574633906	11.0533351173626	11.0377836100988	11.0221028903694	11.0062929065083	10.9903536064131	10.9742849375453	10.9580868469302	10.9417592811571	10.9253021863791	10.9087155083130	10.8919991922399	10.8751531830042	10.8581774250144	10.8410718622429	10.8238364382255	10.8064710960618	10.7889757784151	10.7713504275122	10.7535949851433	10.7357093926621	10.7176935909856	10.6995475205940	10.6812711215306	10.6628643334018	10.6443270953770	10.6256593461881	10.6068610241301	10.5879320670604	10.5688724123989	10.5496819971277	10.5303607577912	10.5109086304960	10.4913255509583	10.4716114543122	10.4517662753978	10.4317899485683	10.4116824077383	10.3914435863836	10.3710734175411	10.3505718338083	10.3299387673436	10.3091741498658	10.2882779126540	10.2672499865476	10.2460903019459	10.2247987888078	10.2033753766521	10.1818199945569	10.1601325711595	10.1383130346563	10.1163613128024	10.0942773329118	10.0720610218567	10.0497123060677	10.0272311115334	10.0046173638002	9.98187098797208	9.95899190871062	9.93598005023444	9.91283533631923	9.88955769029742	9.86614703505803	9.84260329304639	9.81892638626397	9.79511623626810	9.77117276417184	9.74709589064364	9.72288553590719	9.69854161974117	9.67406406147900	9.64945278000864	9.62470769377232	9.59982872076635	9.57481577854084	9.54966878419948	9.52438765439928	9.49897230535040	9.47342265281579	9.44773861211106	9.42192009810416	9.39596702521518	9.36987930741605	9.34365685823035	9.31729959073302	9.29080741755014	9.26418025085864	9.23741800238609	9.21052058341038	9.18348790475955	9.15631987681145	9.12901640949357	9.10157741228270	9.07400279420471	9.04629246383428	9.01844632929466	8.99046429825736	8.96234627794194	8.93409217511570	8.90570189609346	8.87717534673725	8.84851243245608	8.81971305820563	8.79077712848802	8.76170454735152	8.73249521839030	8.70314904474413	8.67366592909813	8.64404577368250	8.61428848027222	8.58439395018678	8.55436208428996	8.52419278298948	8.49388594623676	8.46344147352665	8.43285926389713	8.40213921592906	8.37128122774586	8.34028519701327	8.30915102093906	8.27787859627273	8.24646781930527	8.21491858586882	8.18323079133644	8.15140433062181	8.11943909817892	8.08733498800183	8.05509189362436	8.02270970811981	7.99018832410068	7.95752763371836	7.92472752866288	7.89178790016261	7.85870863898395	7.82548963543110	7.79213077934568	7.75863196010654	7.72499306662941	7.69121398736662	7.65729461030683	7.62323482297473	7.58903451243074	7.55469356527073	7.52021186762573	7.48558930516164	7.45082576307891	7.41592112611231	7.38087527853056	7.34568810413612	7.31035948626481	7.27488930778560	7.23927745110027	7.20352379814313	7.16762823038071	7.13159062881148	7.09541087396559	7.05908884590449	7.02262442422073	6.98601748803760	6.94926791600887	6.91237558631848	6.87534037668025	6.83816216433758	6.80084082606318	6.76337623815872	6.72576827645460	6.68801681630960	6.65012173261061	6.61208289977235	6.57390019173705	6.53557348197415	6.49710264348002	6.45848754877767	6.41972806991644	6.38082407847169	6.34177544554455	6.30258204176158	6.26324373727448	6.22376040175983	6.18413190441875	6.14435811397664	6.10443889868285	6.06437412631042	6.02416366415574	5.98380737903831	5.94330513730040	5.90265680480677	5.86186224694438	5.82092132862208	5.77983391427033	5.73859986784091	5.69721905280660	5.65569133216090	5.61401656841775	5.57219462361120	5.53022535929515	5.48810863654306	5.44584431594759	5.40343225762041	5.36087232119182	5.31816436579142	5.27530825010509	5.23230383231737	5.18915097013027	5.14584952076303	5.10239934095175	5.05880028694920	5.01505221452441	4.97115497896249	4.92710843506427	4.88291243714601	4.83856683903914	4.79407149408996	4.74942625515934	4.70463097462244	4.65968550436842	4.61458969580013	4.56934339983386	4.52394646689903	4.47839874693787	4.43270008940521	4.38685034326812	4.34084935700565	4.29469697860854	4.24839305557897	4.20193743493019	4.15532996318632	4.10857048638203	4.06165885006223	4.01459489928184	3.96737847860547	3.92000943210713	3.87248760336995	3.82481283548595	3.77698497105569	3.72900385218801	3.68086932049975	3.63258121711548	3.58413938266722	3.53554365729414	3.48679388064228	3.43788989186432	3.38883152961923	3.33961863207205	3.29025103689357	3.24072858126009	3.19105110185313	3.14121843485913	3.09123041596921	3.04108688037887	2.99078766278776	2.94033259739933	2.88972151792063	2.83895425756199	2.78803064903679	2.73695052456115	2.68571371585367	2.63432005414383	2.58276937014572	2.53106149408377	2.47919625568386	2.42717348417295	2.37499300827892	2.32265465623026	2.27015825575577	2.21750363408435	2.16469061794472	2.11171903356513	2.05858870667312	2.00529946249528	1.95185112575692	1.89824352068190	1.84447647099228	1.79054979990813	1.73646333014725	1.68221688392487	1.62781028295346	1.57324334844243	1.51851590109791	1.46362776112244];

curve02 = [11.2129254239287	11.2134316459979	11.2133211138296	11.2130016359068	11.2125211248968	11.2118948199073	11.2111294914832	11.2102287346790	11.2091946854435	11.2080287152740	11.2067317563517	11.2053044703527	11.2037473432157	11.2020607416950	11.2002449488111	11.1983001869917	11.1962266336985	11.1940244322904	11.1916936997648	11.1892345323946	11.1866470099132	11.1839311986737	11.1810871540687	11.1781149224121	11.1750145424167	11.1717860463702	11.1684294610796	11.1649448086362	11.1613321070417	11.1575913707234	11.1537226109622	11.1497258362500	11.1456010525906	11.1413482637533	11.1369674714893	11.1324586757165	11.1278218746778	11.1230570650783	11.1181642422035	11.1131434000222	11.1079945312771	11.1027176275631	11.0973126793967	11.0917796762775	11.0861186067416	11.0803294584103	11.0744122180323	11.0683668715220	11.0621934039934	11.0558917997909	11.0494620425165	11.0429041150545	11.0362179995938	11.0294036776485	11.0224611300752	11.0153903370907	11.0081912782861	11.0008639326413	10.9934082785369	10.9858242937661	10.9781119555449	10.9702712405219	10.9623021247869	10.9542045838790	10.9459785927945	10.9376241259930	10.9291411574043	10.9205296604341	10.9117896079694	10.9029209723834	10.8939237255402	10.8847978387991	10.8755432830187	10.8661600285604	10.8566480452919	10.8470073025906	10.8372377693461	10.8273394139636	10.8173122043660	10.8071561079967	10.7968710918214	10.7864571223307	10.7759141655418	10.7652421870001	10.7544411517816	10.7435110244939	10.7324517692780	10.7212633498097	10.7099457293008	10.6984988705005	10.6869227356964	10.6752172867157	10.6633824849263	10.6514182912376	10.6393246661016	10.6271015695134	10.6147489610124	10.6022667996828	10.5896550441545	10.5769136526034	10.5640425827165	10.5510417919439	10.5379112369588	10.5246508741280	10.5112606593670	10.4977405481409	10.4840904954646	10.4703104559030	10.4564003835717	10.4423602321370	10.4281899548166	10.4138895043796	10.3994588331468	10.3848978929911	10.3702066353375	10.3553850111636	10.3404329709995	10.3253504649282	10.3101374425858	10.2947938531613	10.2793196453971	10.2637147675892	10.2479791675867	10.2321127927927	10.2161155901637	10.1999875062101	10.1837284869962	10.1673384781401	10.1508174248139	10.1341652717435	10.1173819632090	10.1004674430445	10.0834216546380	10.0662445409316	10.0489360444214	10.0314961071575	10.0139246707440	9.99622167633897	9.97838706465442	9.96042077595621	9.94232275006406	9.92409292635146	9.90573124374566	9.88723764072756	9.86861205533166	9.84985442514602	9.83096468731211	9.81194277852480	9.79278863503222	9.77350219263573	9.75408338668973	9.73453215210168	9.71484842333187	9.69503213439344	9.67508321885216	9.65500160982637	9.63478723998687	9.61444004155676	9.59395994631136	9.57334688557803	9.55260079023612	9.53172159071671	9.51070921700261	9.48956359862814	9.46828466467898	9.44687234379208	9.42532656415546	9.40364725350810	9.38183433913976	9.35988774789084	9.33780740615220	9.31559323986504	9.29324517452068	9.27076313516047	9.24814704637556	9.22539683230675	9.20251241664433	9.17949372262792	9.15634067304625	9.13305319023703	9.10963119608674	9.08607461203048	9.06238335905177	9.03855735768235	9.01459652800202	8.99050078963846	8.96627006176702	8.94190426311054	8.91740331193916	8.89276712607014	8.86799562286761	8.84308871924246	8.81804633165207	8.79286837610015	8.76755476813655	8.74210542285701	8.71652025490299	8.69079917846149	8.66494210726479	8.63894895459028	8.61281963326028	8.58655405564175	8.56015213364614	8.53361377872920	8.50693890189069	8.48012741367425	8.45317922416714	8.42609424300004	8.39887237934680	8.37151354192429	8.34401763899214	8.31638457835250	8.28861426734989	8.26070661287091	8.23266152134404	8.20447889873944	8.17615865056871	8.14770068188467	8.11910489728112	8.09037120089264	8.06149949639435	8.03248968700167	8.00334167547013	7.97405536409509	7.94463065471158	7.91506744869399	7.88536564695590	7.85552514994983	7.82554585766700	7.79542766963710	7.76517048492808	7.73477420214586	7.70423871943418	7.67356393447429	7.64274974448474	7.61179604622117	7.58070273597602	7.54946970957835	7.51809686239356	7.48658408932318	7.45493128480462	7.42313834281091	7.39120515685050	7.35913161996700	7.32691762473893	7.29456306327950	7.26206782723635	7.22943180779133	7.19665489566022	7.16373698109253	7.13067795387124	7.09747770331255	7.06413611826564	7.03065308711244	6.99702849776737	6.96326223767708	6.92935419382025	6.89530425270732	6.86111230038022	6.82677822241217	6.79230190390740	6.75768322950093	6.72292208335830	6.68801834917533	6.65297191017786	6.61778264912155	6.58245044829159	6.54697518950244	6.51135675409764	6.47559502294949	6.43968987645888	6.40364119455496	6.36744885669495	6.33111274186388	6.29463272857432	6.25800869486615	6.22124051830631	6.18432807598853	6.14727124453312	6.11006990008667	6.07272391832185	6.03523317443713	5.99759754315654	5.95981689872942	5.92189111493016	5.88382006505798	5.84560362193662	5.80724165791417	5.76873404486276	5.73008065417832	5.69128135678036	5.65233602311168	5.61324452313815	5.57400672634844	5.53462250175381	5.49509171788778	5.45541424280596	5.41558994408577	5.37561868882617	5.33550034362167	5.29523477463949	5.25482184754175	5.21426142751119	5.17355337925083	5.13269756698375	5.09169385445286	5.05054210492063	5.00924218116883	4.96779394549831	4.92619725972875	4.88445198519839	4.84255798276378	4.80051511279956	4.75832323519819	4.71598220936972	4.67349189424151	4.63085214825801	4.58806282938053	4.54512379508693	4.50203490237145	4.45879600774439	4.41540696723193	4.37186763637583	4.32817787023323	4.28433752337638	4.24034644989237	4.19620450338294	4.15191153696420	4.10746740326639	4.06287195443364	4.01812504212374	3.97322651750785	3.92817623127032	3.88297403360838	3.83761977423198	3.79211330236345	3.74645446673734	3.70064311560015	3.65467909671006	3.60856225733674	3.56229244426108	3.51586950377492	3.46929328168090	3.42256362329213	3.37568037343199	3.32864337643389	3.28145247614104	3.23410751590618	3.18660833859139	3.13895478656780	3.09114670171540	3.04318392542278	2.99506629858690	2.94679366161285	2.89836585441363	2.84978271640989	2.80104408652972	2.75214980320841	2.70309970437690	2.65389362749552	2.60453140951975	2.55501288691137	2.50533789563815	2.45550627117372	2.40551784849726	2.35537246209330	2.30506994595150	2.25461013356642	2.20399285793728	2.15321795156773	2.10228524646566	2.05119457414292	1.99994576561514	1.94853865140148	1.89697306152442	1.84524882550952	1.79336577238521	1.74132373068257	1.68912252843511	1.63676199317853	1.58424195195052	1.53156223129053	1.47872265723955	1.42572305533991	1.37256325063504	1.31924306766925	1.26576233049020	1.21212086264068	1.15831848716637	1.10435502661301	1.05023030302613	0.995944137950874	0.941496352431784	0.886886767012572	0.832115201735917	0.777181476143261	0.722085409274588	0.666826819665611	0.611405525355416	0.555821343878390];

curve03 = [0.00681	11.91590;
0.09295	11.79140;
0.20584	11.47800;
0.29079	11.05880;
0.39900	10.32420;
0.50020	9.37895;
0.59906	8.26524;
0.690922	7.02507;
0.800208	5.30106;
0.900169	3.42948;
0.994309	1.55777];

curve04 = [0.00093	11.15790;
0.08939	11.03350;
0.21160	10.69920;
0.30818	10.17490;
0.40591	9.46118;
0.49664	8.62098;
0.58271	7.63332;
0.70946	5.93073;
0.82106	4.08044;
0.89429	2.67146;
0.99772	0.54732];

%% Plots

figure
plot(r, curve01, 'b', 'Color', "#EDB120")
hold on
plot(curve03(:,1), curve03(:,2), 'x', 'Color', "#EDB120")
plot(r, curve02, 'g', 'Color', "#0072BD")
plot(curve04(:,1), curve04(:,2), 'xg', 'Color', "#0072BD")
hold off
legend( ...
    'Bi = 15', ...
    'Bi = 15 (Soares2017)', ...
    'Bi = 40', ...
    'Bi = 40 (Soares2017)')
xlabel('Raio')
ylabel('Temperatura')
grid